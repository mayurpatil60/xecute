@using xpPortal.Models
@model NewJoinee
@{
    ViewBag.Title = "ViewDocument";
    Layout = "~/Views/Shared/RecruiterLayout.cshtml";
}
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="ThemeBucket">
    <link rel="shortcut icon" href="images/favicon.png">
    <title>Login</title>
    <!--Core CSS -->
    @*<link href="bs3/css/bootstrap.min.css" rel="stylesheet">
        <link href="css/bootstrap-reset.css" rel="stylesheet">
        <link href="font-awesome/css/font-awesome.css" rel="stylesheet" />*@

    <link href="~/Content/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/bootstrap-reset.css" rel="stylesheet" />
    <link href="~/Content/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <!-- Custom styles for this template -->
    <link href="~/Content/Style.css" rel="stylesheet">
    <link href="~/Content/style-responsive.css" rel="stylesheet" />
    <script type="text/javascript" src="jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
</head>

@*<h2 style="background-color: #1fb5ad;color: #fff;border-radius: 18px;padding-left: 18px;height: 46px;padding-top: 4px;">
    List Of documents submitted by applicant 
</h2>*@
<div class="row">
    <div class="col-sm-12">
        <section class="panel">
            <header class="panel-heading header-class">
                New Joinees
                <span class="tools pull-right">
                    <a href="javascript:;" class="fa fa-chevron-down"></a>                  
                </span>
            </header>
            <div class="panel-body">
                <form id="submitFull" class="form-horizontal">
                    <div>
                        <table class="table table-striped table-hover general-table" id="example">
                            <thead>
                                <tr>
                                    <th>Document ID</th>
                                    <th>
                                        Document Name
                                    </th>
                                    <th>
                                        Type
                                    </th>
                                    <th>
                                        Link
                                    </th>
                                    <th>
                                        Status
                                    </th>
                                    <th>
                                        Approve/Reject
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                @{
                                    foreach (System.Data.DataRow row in Model.NewJoineeList)
                                    {
                                        int i = 0;
                                        <tr>
                                            @foreach (var cell in row.ItemArray)
                                            {
                                                i++;
                                                if (i == 4)
                                                {
                                                    <td><a target="_blank" href="@cell.ToString()">View</a></td>
                                                }
                                                else if (i == 6)
                                                {
                                                    <td><input type="button" class="btn btn-success" onclick="ApproveDocument(@row.ItemArray[0]);" value="Approve" />&nbsp;&nbsp;<input type="button" class="btn btn-danger" onclick="RejectDocument(@row.ItemArray[0]);" value="Reject" /></td>
                                                }
                                                else
                                                {
                                                    <td>@cell.ToString()</td>
                                                }
                                            }
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>

                    </div>
                </form>
            </div>
        </section>
    </div>
</div>
<script language="javascript">
        $('#example tbody').on('click', 'tr', function () {
            debugger;
            var email = $(this).find("td").eq(4).text();
            var dataToPost = "&EmailId=" + email;
            $.post("GetDetailInfo", dataToPost)
                .done(function (response, status, jqxhr) {
                    window.location.href = '/Recruiter/GetDetailInfo'
                })
                .fail(function (jqxhr, status, error) {
                    // this is the ""error"" callback
                })
        });

        function ApproveDocument(documentID) {
            $.ajax({
                type: "GET",
                url: '/Document/Approvedocument',
                contentType: JSON,                
                data: { "documentID": documentID },
                success: function (result) {
                    // alert(result);
                    window.location.href = window.location.href;
                },
                error: function (xhr, status, p3, p4) {
                    var err = "Error " + " " + status + " " + p3 + " " + p4;
                    if (xhr.responseText && xhr.responseText[0] == "{")
                        err = JSON.parse(xhr.responseText).Message;
                }
            });
        }

        function RejectDocument(documentID) {
            $.ajax({
                type: "GET",
                url: '/Document/RejectDocument',
                contentType: JSON,                
                data: { "documentID": documentID },
                success: function (result) {
                    //nothing
                    window.location.href = window.location.href;
                },
                error: function (xhr, status, p3, p4) {
                    var err = "Error " + " " + status + " " + p3 + " " + p4;
                    if (xhr.responseText && xhr.responseText[0] == "{")
                        err = JSON.parse(xhr.responseText).Message;
                }
            });
        }


</script>


